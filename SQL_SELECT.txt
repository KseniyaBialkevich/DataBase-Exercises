CREATE TABLE Регион (КодРегиона int PRIMARY KEY, 
						Страна nvarchar (20) default 'Беларусь' not null, 
						Область nvarchar (20) not null, 
						Город nvarchar (20) not null, 
						Адрес nvarchar (50) not null, 
						Телефон nchar (15) null);

INSERT INTO Регион 
VALUES (101, 'Россия', 'Московская', 'Королев', 'ул. Мира, 15', '387-23-04'),
	(201, 'Беларусь', '', 'Минск', 'ул. Гикало, 9', '456-78-90'),
	(202, 'Беларусь', 'Минская', 'Воложин', 'ул. Серова, 11', NULL),
	(203, 'Беларусь', '', 'Минск', 'ул. Кирова, 24', '269-1376'),
	(204, 'Беларусь', 'Витебская', 'Полоцк', 'ул. Лесная, 6', NULL),
	(301, 'Украина', 'Крымская', 'Алушта', 'ул. Франко, 24', NULL);


-- 1. Выборка всех столбцов и всех строк таблицы Регион

SELECT *From Регион;


-- 2. Выборка некоторых столбцов и всех строк (вертикальный фильтр)

SELECT Город, Адрес, Телефон
FROM  Регион;


-- 3. Выборка всех столбцов и некоторых строк (горизонтальный фильтр)

SELECT *From Регион
WHERE Страна = 'Беларусь' AND Город != 'Минск';


-- 4. Выборка некоторых столбцов и некоторых строк (вертикальный и горизонтальный фильтры)

SELECT Город, Адрес, Телефон
FROM Регион
WHERE Страна = 'Беларусь' AND Город != 'Минск';


-- 5. Выборка с сортировкой строк по столбцу Страна, а при совпадении городов - по столбцу Город

SELECT *FROM Регион
ORDER BY Страна, Город


-- 6. Группировка по полю Страна

SELECT Страна
FROM Регион
GROUP BY Страна


-- 7. Вывести страны и адреса с группировкой по странам

SELECT Страна, Адрес 
FROM Регион
GROUP BY Страна -- Error!!! Because we need a CONDITION for grouping.


-- 8. Подсчитать число Клиентов из каждой страны

SELECT Страна, COUNT (Адрес) AS [Число Клиентов]
FROM Регион 
GROUP BY Страна


-- 9. Вывести страны, где число Клиентов больше 2

SELECT Страна, COUNT (Адрес) AS [Число Клиентов]
FROM РегионGROUP BY Страна
WHERE COUNT (Адрес) > 2 -- Error!!! Because we need a condition: HAVING


-- 10. Вывести страны, где число Клиентов больше 2

SELECT Страна, COUNT (Адрес) AS [Число Клиентов]
FROM Регион
GROUP BY Страна
HAVING COUNT (Адрес) > 2


-- 11. Группировка по двум полям

SELECT Страна, Город
FROM Регион
GROUP BY Страна, Город


-- 12. Группировка по двум полям и агрегатная функция

SELECT Страна, Город, COUNT (Адрес) AS [Число клиентов]
FROM Регион
GROUP BY Страна, Город